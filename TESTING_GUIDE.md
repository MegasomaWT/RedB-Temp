# üöÄ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é REDB

–≠—Ç–æ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –æ–ø–∏—Å—ã–≤–∞–µ—Ç –∫–∞–∫ –∑–∞–ø—É—Å–∫–∞—Ç—å —Ç–µ—Å—Ç—ã REDB –∏ —á—Ç–æ –¥–µ–ª–∞–µ—Ç –∫–∞–∂–¥—ã–π —ç—Ç–∞–ø —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è.

## üìã –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤
```bash
dotnet run
```

### –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
```bash
# –û–¥–∏–Ω —ç—Ç–∞–ø
dotnet run -- --stages 17

# –ù–µ—Å–∫–æ–ª—å–∫–æ —ç—Ç–∞–ø–æ–≤
dotnet run -- --stages 13,16,17

# –°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤
dotnet run -- --list

# –°–ø—Ä–∞–≤–∫–∞
dotnet run -- --help
```

## üîß –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. **PostgreSQL –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö** –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –∑–∞–ø—É—â–µ–Ω–∞ –∏ –¥–æ—Å—Ç—É–ø–Ω–∞
2. **–°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è** –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞ –≤ `appsettings.json`
3. **–°—Ö–µ–º–∞ REDB** –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å–æ–∑–¥–∞–Ω–∞ (–≤—ã–ø–æ–ª–Ω–∏—Ç—å SQL –∏–∑ `redb.Core.Postgres/sql/redbPostgre.sql`)

## üìä –û–ø–∏—Å–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### üîó –≠—Ç–∞–ø 1: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
**–ö–æ–º–∞–Ω–¥–∞:** `dotnet run -- --stages 1`

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL
- –ü–æ–ª—É—á–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑–º–µ—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
DB Type: Postgresql
DB Version: PostgreSQL 17.5 (Debian 17.5-1.pgdg120+1)...
DB Size: 10415251 bytes
```

---

### üîó –≠—Ç–∞–ø 2: –ó–∞–≥—Ä—É–∑–∫–∞ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ –æ–±—ä–µ–∫—Ç–∞
**–ö–æ–º–∞–Ω–¥–∞:** `dotnet run -- --stages 2`

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –ó–∞–≥—Ä—É–∑–∫–∞ –æ–±—ä–µ–∫—Ç–∞ –ø–æ ID —á–µ—Ä–µ–∑ `get_object_json()`
- –î–µ—Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è JSON –≤ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –æ–±—ä–µ–∫—Ç
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –û–±—ä–µ–∫—Ç –∑–∞–≥—Ä—É–∂–µ–Ω: id=1021, name='AnalyticsRecord Example', scheme_id=1002
   Properties: Article='–ø—Ç 5—Ö260', Date=07/15/2025 00:00:00, Stock=151
```

---

### üîó –≠—Ç–∞–ø 3: Code-First —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ö–µ–º—ã
**–ö–æ–º–∞–Ω–¥–∞:** `dotnet run -- --stages 3`

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –°–æ–∑–¥–∞–Ω–∏–µ/–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ö–µ–º—ã –∏–∑ C# –∫–ª–∞—Å—Å–∞
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä –ø–æ–ª–µ–π
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ Scheme ID: 1050001, —Å—Ç—Ä—É–∫—Ç—É—Ä—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã
```

---

### üîó –≠—Ç–∞–ø 13: –û—Å–Ω–æ–≤–Ω—ã–µ LINQ-–∑–∞–ø—Ä–æ—Å—ã
**–ö–æ–º–∞–Ω–¥–∞:** `dotnet run -- --stages 13`

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- –ë–∞–∑–æ–≤—ã–µ LINQ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã: `Where()`, `CountAsync()`, `ToListAsync()`
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –ø—Ä–æ—Å—Ç—ã–º —É—Å–ª–æ–≤–∏—è–º
- –°–ª–æ–∂–Ω—ã–µ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ —É—Å–ª–æ–≤–∏—è (AND)

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**
```csharp
// –ü—Ä–æ—Å—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è
.Where(p => p.Stock > 100)

// –°–ª–æ–∂–Ω–æ–µ —É—Å–ª–æ–≤–∏–µ
.Where(p => p.Category == "Electronics" && p.IsActive == true)

// –ü–æ–¥—Å—á–µ—Ç
.CountAsync()
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ù–∞–π–¥–µ–Ω–æ 1 –ø—Ä–æ–¥—É–∫—Ç–æ–≤ —Å Stock > 100
‚úÖ –ù–∞–π–¥–µ–Ω–æ 2 –∞–∫—Ç–∏–≤–Ω—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤
‚úÖ –í—Å–µ–≥–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤: 4, –ê–∫—Ç–∏–≤–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–æ–≤: 3
```

---

### üîó –≠—Ç–∞–ø 16: –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–µ LINQ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
**–ö–æ–º–∞–Ω–¥–∞:** `dotnet run -- --stages 16`

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- `AnyAsync()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è –∑–∞–ø–∏—Å–µ–π
- `AnyAsync(predicate)` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è —Å —É—Å–ª–æ–≤–∏–µ–º
- `WhereIn()` - —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É –∑–Ω–∞—á–µ–Ω–∏–π
- –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**
```csharp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è
.AnyAsync()
.AnyAsync(p => p.Price > 1000)

// –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–ø–∏—Å–∫—É
.WhereIn(p => p.Category, new[] { "Electronics", "Books" })
.WhereIn(p => p.Price, new[] { 50, 200, 400 })
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –ï—Å—Ç—å –ª–∏ –ø—Ä–æ–¥—É–∫—Ç—ã: True
‚úÖ –ï—Å—Ç—å –ª–∏ –¥–æ—Ä–æ–≥–∏–µ –ø—Ä–æ–¥—É–∫—Ç—ã (>$1000): True
‚úÖ –ù–∞–π–¥–µ–Ω–æ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏—è—Ö [Electronics, Books]: 5
```

---

### üîó –≠—Ç–∞–ø 17: –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ LINQ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã
**–ö–æ–º–∞–Ω–¥–∞:** `dotnet run -- --stages 17`

**–ß—Ç–æ —Ç–µ—Å—Ç–∏—Ä—É–µ—Ç—Å—è:**
- `AllAsync()` - —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è –∫–≤–∞–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
- `Select()` - –ø—Ä–æ–µ–∫—Ü–∏—è –ø–æ–ª–µ–π
- `Distinct()` - —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è –ø–æ —Ö–µ—à—É –±–∏–∑–Ω–µ—Å-—Å–≤–æ–π—Å—Ç–≤

**–ü—Ä–∏–º–µ—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤:**
```csharp
// –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –í–°–ï –∑–∞–ø–∏—Å–∏ —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—Ç —É—Å–ª–æ–≤–∏—é
.AllAsync(p => p.Price > 0)

// –ü—Ä–æ–µ–∫—Ü–∏—è –ø–æ–ª–µ–π
.Select(p => p.name)
.Select(p => new { Name = p.name, Price = p.properties.Price })

// –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è (–ø–æ —Ö–µ—à—É –±–∏–∑–Ω–µ—Å-–¥–∞–Ω–Ω—ã—Ö)
.Distinct()
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚úÖ –í—Å–µ –∞–∫—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–¥—É–∫—Ç—ã –∏–º–µ—é—Ç —Ü–µ–Ω—É > 0: True
‚úÖ –í—Å–µ –ø—Ä–æ–¥—É–∫—Ç—ã –¥–æ—Ä–æ–≥–∏–µ (>$1000): False
üìä –ò–º–µ–Ω–∞ –ø—Ä–æ–¥—É–∫—Ç–æ–≤ (7): Cheap Laptop, Tablet, Old Book...
‚úÖ Distinct() —É–±—Ä–∞–ª –¥—É–±–ª–∏–∫–∞—Ç—ã: 7 ‚Üí 6 (—É–±—Ä–∞–Ω–æ 1 –¥—É–±–ª–∏–∫–∞—Ç–æ–≤)
```

---

## üéØ –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö LINQ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
```bash
dotnet run -- --stages 13,16,17
```

### –ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã
```bash
dotnet run
```

## üîç –û—Ç–ª–∞–¥–∫–∞ –∏ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–°–∏—Å—Ç–µ–º–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è `Debug` –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:
- –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º—ã–µ JSON —Ñ–∏–ª—å—Ç—Ä—ã
- SQL –∑–∞–ø—Ä–æ—Å—ã –∫ PostgreSQL
- –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –¢–∏–ø–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**1. –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:**
```
Npgsql.PostgresException: connection failed
```
**–†–µ—à–µ–Ω–∏–µ:** –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç—Ä–æ–∫—É –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –≤ `appsettings.json`

**2. –§—É–Ω–∫—Ü–∏—è –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:**
```
function search_objects_with_facets(...) does not exist
```
**–†–µ—à–µ–Ω–∏–µ:** –í—ã–ø–æ–ª–Ω–∏—Ç—å SQL —Å–∫—Ä–∏–ø—Ç `redb.Core.Postgres/sql/redbPostgre.sql`

**3. –°—Ö–µ–º–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:**
```
Scheme not found
```
**–†–µ—à–µ–Ω–∏–µ:** –ó–∞–ø—É—Å—Ç–∏—Ç—å —ç—Ç–∞–ø 3 –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Å—Ö–µ–º—ã

## üìä –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
```bash
# –¢–µ—Å—Ç –±–∞–∑–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
dotnet run -- --stages 1,2,3

# –¢–µ—Å—Ç LINQ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
dotnet run -- --stages 13,16,17
```

### –ú–µ—Ç—Ä–∏–∫–∏
- **–í—Ä–µ–º—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ –ë–î:** < 100ms
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ—Å—Ç–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:** < 50ms
- **–í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å–ª–æ–∂–Ω–æ–≥–æ LINQ –∑–∞–ø—Ä–æ—Å–∞:** < 200ms

## üöÄ –ì–æ—Ç–æ–≤—ã–µ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å
```csharp
var products = await redb.QueryAsync<ProductProps>("Products")
    .Where(p => p.IsActive == true)
    .ToListAsync();
```

### –°–ª–æ–∂–Ω—ã–π –∑–∞–ø—Ä–æ—Å —Å –ø—Ä–æ–µ–∫—Ü–∏–µ–π
```csharp
var summary = await redb.QueryAsync<ProductProps>("Products")
    .Where(p => p.Stock > 100 && p.Category == "Electronics")
    .OrderByDescending(p => p.Price)
    .Take(10)
    .Select(p => new { p.name, p.properties.Price })
    .ToListAsync();
```

### –ê–≥—Ä–µ–≥–∞—Ü–∏–∏
```csharp
var hasExpensive = await redb.QueryAsync<ProductProps>("Products")
    .AnyAsync(p => p.Price > 1000);

var allActive = await redb.QueryAsync<ProductProps>("Products")
    .AllAsync(p => p.IsActive == true);

var count = await redb.QueryAsync<ProductProps>("Products")
    .Where(p => p.Category == "Electronics")
    .CountAsync();
```

---

## üìã –ß–µ–∫-–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º

- [ ] PostgreSQL –∑–∞–ø—É—â–µ–Ω –∏ –¥–æ—Å—Ç—É–ø–µ–Ω
- [ ] –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–Ω–∞
- [ ] SQL —Å—Ö–µ–º–∞ REDB –≤—ã–ø–æ–ª–Ω–µ–Ω–∞
- [ ] –°—Ç—Ä–æ–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∞
- [ ] –ü—Ä–æ–µ–∫—Ç —Å–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞–Ω (`dotnet build`)

## üéâ –£—Å–ø–µ—à–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ

–ü—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –≤—Å–µ—Ö —ç—Ç–∞–ø–æ–≤ –≤—ã —É–≤–∏–¥–∏—Ç–µ:
```
üìä === –ò–¢–û–ì–ò –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø ===
‚úÖ –£—Å–ø–µ—à–Ω–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ: 6/6 —ç—Ç–∞–ø–æ–≤
üéâ === –í–°–ï –≠–¢–ê–ü–´ –ó–ê–í–ï–†–®–ï–ù–´ –£–°–ü–ï–®–ù–û ===
```

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ REDB –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω –∏ –≥–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é! üöÄ
