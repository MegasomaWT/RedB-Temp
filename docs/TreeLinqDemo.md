# üå≥ –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö LINQ-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ REDB

*–†–µ–∞–ª–∏—Å—Ç–∏—á–Ω—ã–µ –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏ —Å –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π –∏–µ—Ä–∞—Ä—Ö–∏–µ–π*

---

## üìã –û–±–∑–æ—Ä

**Stage33** –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç –º–æ—â–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö LINQ-–∑–∞–ø—Ä–æ—Å–æ–≤ –≤ REDB –Ω–∞ –ø—Ä–∏–º–µ—Ä–µ –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä—ã IT-–∫–æ–º–ø–∞–Ω–∏–∏ "–¢–µ—Ö–ö–æ—Ä–ø". 

### üéØ –ß—Ç–æ –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç—Å—è:
- ‚úÖ **8 –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö LINQ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤**
- ‚úÖ **10 —Ä–µ–∞–ª—å–Ω—ã—Ö –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤**  
- ‚úÖ **–ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏**
- ‚úÖ **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –∏–µ—Ä–∞—Ä—Ö–∏–∏**
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–µ–≤—å–µ–≤**

---

## üè¢ –¢–µ—Å—Ç–æ–≤–∞—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### üìä –ú–∞—Å—à—Ç–∞–± –¥–∞–Ω–Ω—ã—Ö:
- **15 –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π** (4 —É—Ä–æ–≤–Ω—è –∏–µ—Ä–∞—Ä—Ö–∏–∏)
- **20 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤** (—Ä–∞–∑–ª–∏—á–Ω—ã–µ –¥–æ–ª–∂–Ω–æ—Å—Ç–∏ –∏ –∑–∞—Ä–ø–ª–∞—Ç—ã)
- **3 —Ä–µ–≥–∏–æ–Ω–∞** (–ú–æ—Å–∫–≤–∞, –°–ü–ë, –ù–∏–∂–Ω–∏–π –ù–æ–≤–≥–æ—Ä–æ–¥)

### üå≥ –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:

```
üè¢ –¢–µ—Ö–ö–æ—Ä–ø - –ì–æ–ª–æ–≤–Ω–∞—è –∫–æ–º–ø–∞–Ω–∏—è
 ‚îú‚îÄüè¢ –ú–æ—Å–∫–æ–≤—Å–∫–∏–π –æ—Ñ–∏—Å (14 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤)
 ‚îÇ  ‚îú‚îÄüè¢ IT-–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –ú–æ—Å–∫–≤–∞ (8 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤)
 ‚îÇ  ‚îÇ  ‚îú‚îÄüè¢ –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Alpha (3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îÇ  ‚îú‚îÄüè¢ –ö–æ–º–∞–Ω–¥–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ Beta (2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îÇ  ‚îú‚îÄüè¢ –ö–æ–º–∞–Ω–¥–∞ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îÇ  ‚îî‚îÄüè¢ –ö–æ–º–∞–Ω–¥–∞ DevOps (1 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫)
 ‚îÇ  ‚îú‚îÄüè¢ –û—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂ –ú–æ—Å–∫–≤–∞ (3 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îÇ  ‚îú‚îÄüè¢ –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ –ø—Ä–æ–¥–∞–∂–∏ (2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îÇ  ‚îî‚îÄüè¢ –ü—Ä–æ–¥–∞–∂–∏ –º–∞–ª–æ–º—É –±–∏–∑–Ω–µ—Å—É (1 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫)
 ‚îÇ  ‚îî‚îÄüè¢ HR-–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –ú–æ—Å–∫–≤–∞ (2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îú‚îÄüè¢ –°–∞–Ω–∫—Ç-–ü–µ—Ç–µ—Ä–±—É—Ä–≥—Å–∫–∏–π –æ—Ñ–∏—Å (4 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îú‚îÄüè¢ IT-–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç –°–ü–ë (2 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞)
 ‚îÇ  ‚îî‚îÄüè¢ –û—Ç–¥–µ–ª –ø—Ä–æ–¥–∞–∂ –°–ü–ë (1 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫)
 ‚îî‚îÄüè¢ –ù–∏–∂–µ–≥–æ—Ä–æ–¥—Å–∫–∏–π –æ—Ñ–∏—Å (0 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤)
```

---

## üß™ –î–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ–º—ã–µ –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–∏

### 1Ô∏è‚É£ **–ü–æ–∏—Å–∫ IT-–ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π**
```csharp
var itDepartments = await (await redb.TreeQueryAsync<CategoryTestProps>())
    .Where(org => org.Name.Contains("IT"))
    .OrderBy(org => org.Name)
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 2 –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (IT-–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç MSK, IT-–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç SPB)

### 2Ô∏è‚É£ **–ö–æ–º–∞–Ω–¥—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**
```csharp
var devTeams = await (await redb.TreeQueryAsync<CategoryTestProps>())
    .Where(org => org.Name.Contains("Development Team"))
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 2 –∫–æ–º–∞–Ω–¥—ã (Alpha, Beta)

### 3Ô∏è‚É£ **–ú–æ—Å–∫–æ–≤—Å–∫–∏–π –æ—Ñ–∏—Å (–æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–µ–≤–∞)**
```csharp
var moscowPeople = await (await redb.TreeQueryAsync<ProductTestProps>(moscowId, maxDepth: 10))
    .Where(emp => emp.IsActive == true)
    .OrderByDescending(emp => emp.Price) // –ó–∞—Ä–ø–ª–∞—Ç–∞
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 14 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –º–æ—Å–∫–æ–≤—Å–∫–æ–≥–æ –æ—Ñ–∏—Å–∞

### 4Ô∏è‚É£ **–í—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏**
```csharp
var highPaidEmployees = await (await redb.TreeQueryAsync<ProductTestProps>())
    .Where(emp => emp.Price > 120000)
    .Where(emp => emp.IsActive == true)
    .OrderByDescending(emp => emp.Price)
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 20 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ —Å –∑–∞—Ä–ø–ª–∞—Ç–æ–π >120–∫ (–æ—Ç CEO 300–∫ –¥–æ Middle Developer 120–∫)

### 5Ô∏è‚É£ **–ü–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è —Å –∫–æ–º–∞–Ω–¥–∞–º–∏ (HasDescendant)**
```csharp
var managersWithTeams = await (await redb.TreeQueryAsync<CategoryTestProps>())
    .WhereHasDescendant(subordinate => subordinate.IsActive == true)
    .Where(org => org.Description.Contains("–î–µ–ø–∞—Ä—Ç–∞–º–µ–Ω—Ç") || org.Description.Contains("–ö–æ–º–∞–Ω–¥–∞"))
    .OrderBy(org => org.Name)
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 5 –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–¥—á–∏–Ω–µ–Ω–Ω—ã–º–∏

### 6Ô∏è‚É£ **–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —É—Ä–æ–≤–Ω—è–º (WhereLevel)**
```csharp
for (int level = 0; level <= 3; level++)
{
    var employeesAtLevel = await (await redb.TreeQueryAsync<ProductTestProps>())
        .WhereLevel(level)
        .CountAsync();
}
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–¥—Å—á–µ—Ç —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤ –Ω–∞ –∫–∞–∂–¥–æ–º —É—Ä–æ–≤–Ω–µ –∏–µ—Ä–∞—Ä—Ö–∏–∏

### 7Ô∏è‚É£ **–ì–ª—É–±–æ–∫–∏–µ –≤—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ (—É—Å–ª–æ–≤–Ω—ã–π —É—Ä–æ–≤–µ–Ω—å)**
```csharp
var highPaidDeepEmployees = await (await redb.TreeQueryAsync<ProductTestProps>())
    .WhereLevel(level => level > 2)
    .Where(emp => emp.Price > 100000)
    .Where(emp => emp.IsActive == true)
    .OrderByDescending(emp => emp.Price)
    .Take(10)
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—ã—Å–æ–∫–æ–æ–ø–ª–∞—á–∏–≤–∞–µ–º—ã–µ –Ω–∞ –≥–ª—É–±–æ–∫–∏—Ö —É—Ä–æ–≤–Ω—è—Ö –∏–µ—Ä–∞—Ä—Ö–∏–∏

### 8Ô∏è‚É£ **–ö–æ—Ä–Ω–µ–≤—ã–µ –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏—è (WhereRoots)**
```csharp
var rootDepartments = await (await redb.TreeQueryAsync<CategoryTestProps>())
    .WhereRoots()
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 15 –∫–æ—Ä–Ω–µ–≤—ã—Ö –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π —Å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –ø–æ —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∞–º

### 9Ô∏è‚É£ **–ö–æ–Ω–µ—á–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã (WhereLeaves)**
```csharp
var leafTeams = await (await redb.TreeQueryAsync<CategoryTestProps>())
    .WhereLeaves()
    .Where(org => org.Description.Contains("–ö–æ–º–∞–Ω–¥–∞"))
    .ToListAsync();
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** 15 –ª–∏—Å—Ç–æ–≤—ã—Ö –∫–æ–º–∞–Ω–¥ –±–µ–∑ –ø–æ–¥–ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π

### üîü **–ü–æ–ª–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è (ToTreeListAsync)**
```csharp
var fullStructure = await (await redb.TreeQueryAsync<CategoryTestProps>())
    .WhereRoots()
    .ToTreeListAsync(maxDepth: 4);
```
üìä **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–∞—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–æ–Ω–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–µ–π

---

## ‚ö° –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### üîπ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è (5 –∏—Ç–µ—Ä–∞—Ü–∏–π):

| –¢–µ—Å—Ç | –û–ø–∏—Å–∞–Ω–∏–µ | –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è |
|------|----------|---------------|
| **–ü–æ–∏—Å–∫ IT-–ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π** | `Where(org => org.Name.Contains("IT"))` | **7.4 –º—Å** |
| **–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤** | `Where(emp => emp.IsActive && emp.Stock > 30)` | **7.2 –º—Å** |
| **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–æ–µ –ø–æ–¥–¥–µ—Ä–µ–≤–æ** | `TreeQueryAsync(moscowId).Where(...)` | **12.4 –º—Å** |

### üìà –í—ã–≤–æ–¥—ã –ø–æ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏:
- ‚úÖ **–î—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ SQL —Ñ—É–Ω–∫—Ü–∏–∏**
- ‚úÖ **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–¥–¥–µ—Ä–µ–≤–∞ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É—Å–∫–æ—Ä—è–µ—Ç –ø–æ–∏—Å–∫**
- ‚úÖ **–ò–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ –Ω–∞ –±–æ–ª—å—à–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–∞—Ö**

---

## üõ†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã

### üå≥ –ë–∞–∑–æ–≤—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:
- **`.WhereRoots()`** - —Ç–æ–ª—å–∫–æ –∫–æ—Ä–Ω–µ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã
- **`.WhereLeaves()`** - —Ç–æ–ª—å–∫–æ –ª–∏—Å—Ç–æ–≤—ã–µ –æ–±—ä–µ–∫—Ç—ã  
- **`.WhereLevel(int level)`** - –æ–±—ä–µ–∫—Ç—ã –Ω–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–º —É—Ä–æ–≤–Ω–µ
- **`.WhereLevel(level => level > 1)`** - —É—Å–ª–æ–≤–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é
- **`.WhereChildrenOf(long parentId)`** - –ø—Ä—è–º—ã–µ –¥–µ—Ç–∏ –æ–±—ä–µ–∫—Ç–∞
- **`.WhereDescendantsOf(long ancestorId, int? maxDepth = null)`** - –≤—Å–µ –ø–æ—Ç–æ–º–∫–∏

### üå≥ –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –æ–ø–µ—Ä–∞—Ç–æ—Ä—ã:
- **`.WhereHasAncestor(predicate)`** - –æ–±—ä–µ–∫—Ç—ã —Å –ø—Ä–µ–¥–∫–æ–º, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–º —É—Å–ª–æ–≤–∏—é
- **`.WhereHasDescendant(predicate)`** - –æ–±—ä–µ–∫—Ç—ã —Å –ø–æ—Ç–æ–º–∫–æ–º, —É–¥–æ–≤–ª–µ—Ç–≤–æ—Ä—è—é—â–∏–º —É—Å–ª–æ–≤–∏—é

### üå≥ –ú–µ—Ç–æ–¥—ã –∑–∞–≥—Ä—É–∑–∫–∏:
- **`.ToListAsync()`** - –ø–ª–æ—Å–∫–∏–π —Å–ø–∏—Å–æ–∫ `TreeRedbObject<TProps>`
- **`.ToTreeListAsync(maxDepth)`** - –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å children
- **`.CountAsync()`** - –ø–æ–¥—Å—á–µ—Ç –±–µ–∑ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö

---

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### üìä SQL –¥–µ–∫–æ–º–ø–æ–∑–∏—Ü–∏—è:
- **`search_tree_objects_with_facets()`** - –≥–ª–∞–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –¥–µ—Ä–µ–≤—å–µ–≤
- **`build_hierarchical_conditions()`** - –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏–µ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π
- **`build_has_ancestor_condition()`** - –æ–ø–µ—Ä–∞—Ç–æ—Ä `$hasAncestor`
- **`build_has_descendant_condition()`** - –æ–ø–µ—Ä–∞—Ç–æ—Ä `$hasDescendant`
- **`build_level_condition()`** - –æ–ø–µ—Ä–∞—Ç–æ—Ä `$level`

### üîß C# –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- **`PostgresTreeQueryProvider`** - –ø—Ä–æ–≤–∞–π–¥–µ—Ä –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤
- **`PostgresTreeQueryable<TProps>`** - LINQ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ç–æ—Ä–∞–º–∏
- **`TreeQueryContext<TProps>`** - –∫–æ–Ω—Ç–µ–∫—Å—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π rootObjectId –∏ maxDepth
- **`TreeRedbObject<TProps>`** - —Ä–µ–∑—É–ª—å—Ç–∏—Ä—É—é—â–∏–π –æ–±—ä–µ–∫—Ç —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π children

---

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ

### üí° –ü—Ä–∏–º–µ—Ä—ã –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è:

**1. –ö–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã:**
```csharp
// –í—Å–µ IT-—Å–æ—Ç—Ä—É–¥–Ω–∏–∫–∏ –∫–æ–º–ø–∞–Ω–∏–∏
var itStaff = await redb.TreeQueryAsync<Employee>()
    .WhereHasAncestor(dept => dept.Name.Contains("IT"))
    .ToListAsync();

// –ú–µ–Ω–µ–¥–∂–µ—Ä—ã —Å –±–æ–ª—å—à–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏  
var managers = await redb.TreeQueryAsync<Department>()
    .WhereHasDescendant(emp => emp.IsActive)
    .Where(dept => dept.ManagerLevel > 2)
    .ToListAsync();
```

**2. –ö–∞—Ç–∞–ª–æ–≥–∏ —Ç–æ–≤–∞—Ä–æ–≤:**
```csharp
// –í—Å–µ —Ç–æ–≤–∞—Ä—ã –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–≠–ª–µ–∫—Ç—Ä–æ–Ω–∏–∫–∞"
var electronics = await redb.TreeQueryAsync<Product>(electronicsId)
    .Where(p => p.InStock && p.Price > 100)
    .OrderBy(p => p.Price)
    .ToListAsync();

// –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–µ–∑ —Ç–æ–≤–∞—Ä–æ–≤
var emptyCategories = await redb.TreeQueryAsync<Category>()
    .WhereLeaves()
    .Where(cat => !cat.HasProducts)
    .ToListAsync();
```

**3. –§–∞–π–ª–æ–≤—ã–µ —Å–∏—Å—Ç–µ–º—ã:**
```csharp
// –ì–ª—É–±–æ–∫–æ –≤–ª–æ–∂–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
var deepFiles = await redb.TreeQueryAsync<FileNode>()
    .WhereLevel(level => level > 5)
    .Where(file => file.Size > 1000000)
    .ToListAsync();
```

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏

### ‚úÖ **–ß—Ç–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ —É—Å–ø–µ—à–Ω–æ:**
- üè¢ –†–µ–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è –∫–æ—Ä–ø–æ—Ä–∞—Ç–∏–≤–Ω–∞—è –∏–µ—Ä–∞—Ä—Ö–∏—è (15 –ø–æ–¥—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–π, 20 —Å–æ—Ç—Ä—É–¥–Ω–∏–∫–æ–≤)
- üíº 10 –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –±–∏–∑–Ω–µ—Å-—Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ 
- üå≥ 8 –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö LINQ –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤
- ‚ö° –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (7-12 –º—Å)
- üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä—É–∫—Ç—É—Ä—ã
- üéØ –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –ø–æ–∏—Å–∫–∞ –ø–æ–¥–¥–µ—Ä–µ–≤—å—è–º–∏

### üèÜ **–ò—Ç–æ–≥–æ–≤–∞—è –æ—Ü–µ–Ω–∫–∞:**
**REDB —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã–µ LINQ-–∑–∞–ø—Ä–æ—Å—ã –Ω–∞ —ç–Ω—Ç–µ—Ä–ø—Ä–∞–π–∑ —É—Ä–æ–≤–Ω–µ!**

---

## üîó –°–≤—è–∑–∞–Ω–Ω—ã–µ –º–∞—Ç–µ—Ä–∏–∞–ª—ã

- **Stage34** - –£–ø—Ä–æ—â–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- **SQL Functions** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ `search_tree_objects_with_facets()`
- **Tree Providers** - –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ `PostgresTreeProvider`
- **LINQ Extensions** - –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥—Ä–µ–≤–æ–≤–∏–¥–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ç–æ—Ä–æ–≤

---

*–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞ –≤ —Ä–∞–º–∫–∞—Ö –ø—Ä–æ–µ–∫—Ç–∞ REDB - —Ç–∏–ø–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ–π EAV-—Å–∏—Å—Ç–µ–º—ã —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–µ—Ä–∞—Ä—Ö–∏—á–µ—Å–∫–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä.*
